<!-- books.ejs - 교재 선택 페이지 템플릿 -->

<!-- CSS 파일 참조 추가 -->
<link rel="stylesheet" href="/css/report.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">

<%- include('../partials/header') %>

<div class="container mt-5"> 
  <div class="row mb-4">
    <div class="col-md-8 offset-md-2">
      <h1 class="text-center fw-bold mb-2">월간 학습리포트 POD</h1>
      <p class="text-center text-muted">교재 카테고리와 호수를 선택하여 학습 리포트를 생성하세요</p>
    </div>
  </div>
  
  <div class="row">
    <div class="col-md-10 offset-md-1">
      <!-- 코스 컨테이너 -->
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">교재 선택</h4>
        </div>
        <div class="card-body p-3" id="categoryContainer">
          <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">교재 정보를 불러오는 중...</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // API 테스트
  fetch('/report/books')
    .then(response => {
      console.log('API 응답:', response);
      if (!response.ok) {
        throw new Error(`API 응답 오류: ${response.status}`);
      }
      return response.text(); // 일단 텍스트로 받아보기
    })
    .then(text => {
      console.log('응답 내용 (처음 100자):', text.substring(0, 100));
      try {
        // JSON으로 파싱 시도
        const data = JSON.parse(text);
        console.log('파싱된 데이터:', data);
      } catch (error) {
        console.error('JSON 파싱 실패:', error);
      }
    })
    .catch(error => {
      console.error('API 호출 실패:', error);
    });
});
</script>